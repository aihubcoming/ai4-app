import{j as a}from"./radix-ui-5LtdMfNn.js";import{r as i}from"./vendor-B4gEaEGI.js";import{c as C,u as w,a as S,s as x}from"./main-B34cn-84.js";import{B as v,L as l}from"./label-CgCQUnbP.js";import{I as j}from"./input-x-MVjPYt.js";import{T as A}from"./textarea-BBZtVFJu.js";import{C as F,a as k,b as L,c as P,d as B}from"./card-6uTiVmyf.js";import{A as E,b as I,a as T}from"./avatar-DyKoJ1Aj.js";import{A as U,F as M}from"./FileUploadButton-Xz6m5kaz.js";import{u as D}from"./router-CYcLefUh.js";import{L as y}from"./loader-circle-DuZXIeBk.js";import"./supabase-B07dSRCg.js";import"./ui-B2rm_Apj.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=C("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function $(){var m,u,p,f;const{user:r}=w(),{toast:o}=S(),g=D(),[b,n]=i.useState(!0),[c,d]=i.useState(!1),[s,t]=i.useState({username:"",display_name:"",bio:"",avatar_url:""});i.useEffect(()=>{r&&N()},[r]);async function N(){try{n(!0);const{data:e,error:h}=await x.from("profiles").select("*").eq("user_id",r.id).single();if(h)throw h;e&&t({username:e.username||"",display_name:e.display_name||"",bio:e.bio||"",avatar_url:e.avatar_url||""})}catch(e){console.error("Error loading profile:",e)}finally{n(!1)}}async function _(){try{d(!0);const{error:e}=await x.from("profiles").upsert({user_id:r.id,username:s.username,display_name:s.display_name,bio:s.bio,avatar_url:s.avatar_url,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(e)throw e;o({title:"Success",description:"Profile updated successfully."})}catch(e){o({title:"Error",description:e.message||"Failed to update profile",variant:"destructive"})}finally{d(!1)}}return r?a.jsxs("div",{className:"container max-w-2xl mx-auto p-4 md:py-8",children:[a.jsxs(v,{variant:"ghost",onClick:()=>g("/"),className:"mb-4 pl-0 hover:bg-transparent",children:[a.jsx(U,{className:"w-4 h-4 mr-2"}),"Back to Chat"]}),a.jsxs(F,{children:[a.jsxs(k,{children:[a.jsx(L,{children:"Profile Settings"}),a.jsx(P,{children:"Manage your public profile information."})]}),a.jsx(B,{className:"space-y-6",children:b?a.jsx("div",{className:"flex justify-center p-8",children:a.jsx(y,{className:"w-8 h-8 animate-spin text-primary"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsxs(E,{className:"w-24 h-24 border-2 border-border",children:[a.jsx(I,{src:s.avatar_url}),a.jsx(T,{className:"text-2xl",children:((u=(m=s.display_name)==null?void 0:m.charAt(0))==null?void 0:u.toUpperCase())||((f=(p=r.email)==null?void 0:p.charAt(0))==null?void 0:f.toUpperCase())})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(M,{onFileUploaded:e=>t({...s,avatar_url:e.url}),variant:"button",className:"h-8"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(l,{htmlFor:"username",children:"Username"}),a.jsx(j,{id:"username",value:s.username,onChange:e=>t({...s,username:e.target.value}),placeholder:"@username"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(l,{htmlFor:"display_name",children:"Display Name"}),a.jsx(j,{id:"display_name",value:s.display_name,onChange:e=>t({...s,display_name:e.target.value}),placeholder:"Your Name"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(l,{htmlFor:"bio",children:"Bio"}),a.jsx(A,{id:"bio",value:s.bio,onChange:e=>t({...s,bio:e.target.value}),placeholder:"Tell us about yourself...",className:"min-h-[100px]"})]})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsxs(v,{onClick:_,disabled:c,children:[c&&a.jsx(y,{className:"w-4 h-4 mr-2 animate-spin"}),a.jsx(H,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})})]})]}):null}export{$ as default};
